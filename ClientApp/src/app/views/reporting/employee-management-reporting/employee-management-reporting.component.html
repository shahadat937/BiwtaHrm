<c-card>
    <c-card-header class="text-center">
        <h5>Report on Employee Management</h5>
    </c-card-header>
    <c-card-body>
        <div cRow>
            <c-col [md]="3">
                <label cLabel for="informationType">Information Type<span class="text-danger"></span></label>
                <select cSelect class="mb-3" [(ngModel)]="informationType" name="informationType" #infoValue="ngModel" cFormControl (change)="onInfoTypeChange()">
                    <option [ngValue]=0 >Select Information Type</option>
                    <option [ngValue]=1 >Basic Information</option>
                    <option [ngValue]=2 >Personal Information</option>
                    <option [ngValue]=3 >Spouse Information</option>
                    <option [ngValue]=4 >Children Information</option>
                    <option [ngValue]=5 >Address Information</option>
                    <option [ngValue]=6 >Job Details</option>
                    <option [ngValue]=7 >Other Responsibility</option>
                    <option [ngValue]=8 >Work History</option>
                    <option [ngValue]=9 >Education Information</option>
                    <option [ngValue]=10>Training Information</option>
                    <option [ngValue]=11>Bank Information</option>
                    <option [ngValue]=12>Language Details</option>
                    <option [ngValue]=13>Foreign Trip</option>
                </select>
            </c-col>
            
            <c-col [md]="3" *ngIf="informationType == 0">
              <label cLabel for="queryType">Query Type<span class="text-danger"></span></label>
              <select cSelect class="mb-3" [(ngModel)]="queryTypeName" name="queryTypeName" #queryValue="ngModel" cFormControl>
                  <option value="">Select Query Type</option>
              </select>
            </c-col>
            
            <c-col [md]="3" *ngIf="informationType == 1">
              <label cLabel for="queryType">Query Type<span class="text-danger"></span></label>
              <select cSelect class="mb-3" [(ngModel)]="queryTypeName" name="queryTypeName" #queryValue="ngModel" cFormControl (change)="onQueryTypeChange(false)" (change)="resetDeptSection()">
                  <option value="">Select Query Type</option>
                  <option value="Employee Type">Employee Type</option>
                  <option value="Shift Type">Shift Type</option>
              </select>
            </c-col>
            <c-col [md]="3">
              <label cLabel for="Department">Department<span class="text-danger"></span></label>
              <div class="input-wrapper">
                <select (change)="onDepartmentSelect(departmentId)"
                    [(ngModel)]="departmentId" name="departmentId" #Department="ngModel"
                    cFormControl id="Department" aria-label="Default select example" cSelect>
                    <option [ngValue]=0>Select Department</option>
        
                    @for(department of departments; track department.id;let index=$index) {
                    <option [value]="department.id">
                    {{ department.name }}
                    </option>
                    }
                </select>
              </div>
          </c-col>
          
          <c-col [md]="3">
              <label cLabel for="sectionId">Section<span class="text-danger"></span></label>
              <div class="input-wrapper">
                <select [(ngModel)]="sectionId" name="sectionId" #Section="ngModel"
                    cFormControl id="sectionId" aria-label="Default select example" cSelect
                    (change)="onSectionSelect()">
                    <option [ngValue]=0>Select Section</option>
        
                    @for(section of sections; track section.id;let index=$index) {
                    <option [value]="section.id">
                    {{ section.name }}
                    </option>
                    }
                </select>
              </div>
          </c-col>
        </div>

        <div cRow class="d-flex justify-content-center" *ngIf="queryTypeName">
            <c-col [md]="4">
                <div class="ps-3 pe-3 text-light bg-success p-2 rounded" (click)="onTypeValueChange('All', 0)">
                    <h6 class="m-0">All {{queryTypeName}}<label *ngIf="queryCount.totalAssigned > 0">s</label></h6>
                    <p>{{queryCount.totalAssigned}} Employee<label *ngIf="queryCount.totalAssigned > 0">s</label></p>
                </div>
            </c-col>
            <c-col [md]="4">
                <div class="ps-3 pe-3 text-light bg-warning p-2 rounded" (click)="onTypeValueChange('Unassigned', 0)">
                    <h6 class="m-0">No {{queryTypeName}}<label *ngIf="queryCount.totalNull > 0">s</label></h6>
                    <p>{{queryCount.totalNull}} Employee<label *ngIf="queryCount.totalNull > 0">s</label></p>
                </div>
            </c-col>
        </div>
        
        <div cRow class="d-flex justify-content-center mt-3" *ngIf="queryTypeName">
          <c-col *ngFor="let info of queryCount.countReportingInfo; index as i" [md]="3">
            <div class="ps-3 pe-3 text-light bg-danger p-2 rounded"  (click)="onTypeValueChange(info.name, info.id)">
              <h6 class="m-0">{{info.name}}</h6>
              <p>{{info.count}} Employee<label *ngIf="info.count > 0">s</label></p>
            </div>
          </c-col>
        </div>

        <c-card class="mt-2" *ngIf="queryTypeName">
            <c-card-header>
                Employee List - {{queryTypeName}} ({{typeName}})
            </c-card-header>
            <c-card-body class="p-0">
                <div class="table-responsive">
                    <table mat-table [dataSource]="dataSource">
                      <!-- Position Column -->
                      <ng-container matColumnDef="slNo">
                        <th mat-header-cell *matHeaderCellDef>SL</th>
                        <td mat-cell *matCellDef="let element; let i = index">{{ i + 1 }}</td>
                      </ng-container>
                      
                      <ng-container matColumnDef="employee">
                        <th mat-header-cell *matHeaderCellDef>Employee</th>
                        <td mat-cell *matCellDef="let element">
                            {{ element.empName }} ({{ element.idCardNo }})
                        </td>
                      </ng-container>
            
                      <ng-container matColumnDef="department/section">
                        <th mat-header-cell *matHeaderCellDef>Department/Section</th>
                        <td mat-cell *matCellDef="let element">
                          {{ element.departmentName ?? "" }}<label *ngIf="element.sectionName">, {{ element.sectionName}}</label>
                        </td>
                      </ng-container>
                      
                      <ng-container matColumnDef="designation">
                        <th mat-header-cell *matHeaderCellDef>Designation</th>
                        <td mat-cell *matCellDef="let element">
                          {{ element.designationName }}
                        </td>
                      </ng-container>
                      
                      <ng-container matColumnDef="typeName">
                        <th mat-header-cell *matHeaderCellDef>{{queryTypeName}}</th>
                        <td mat-cell *matCellDef="let element">
                          <c-badge color="primary">{{ element.typeName }}</c-badge>
                        </td>
                      </ng-container>
                      
                      <ng-container matColumnDef="phone">
                        <th mat-header-cell *matHeaderCellDef>Contact Number</th>
                        <td mat-cell *matCellDef="let element">
                          {{ element.contactNumber }}
                        </td>
                      </ng-container>
                      
                      <ng-container matColumnDef="status">
                        <th mat-header-cell *matHeaderCellDef>Status</th>
                        <td mat-cell *matCellDef="let element">
                          <c-badge color="success" *ngIf="element.status">Active</c-badge>
                          <c-badge color="warning" *ngIf="!element.status">Inactive</c-badge>
                        </td>
                      </ng-container>
            
                      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                      <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
                    </table>
                  </div>
            </c-card-body>
            <c-card-footer class="text-medium-emphasis p-0">
                <mat-paginator 
                  [length]="pagination.length"
                  [pageSize]="pagination.pageSize"
                  [pageSizeOptions]="pagination.pageSizeOptions"
                  [showFirstLastButtons]="true"
                  (page)="onPageChange($event)">
                </mat-paginator>    
            </c-card-footer>
        </c-card>
    </c-card-body>
</c-card>
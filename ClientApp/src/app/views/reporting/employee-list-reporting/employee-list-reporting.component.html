<c-card>
    <c-card-header class="text-center">
        <h5>Report on Employee List</h5>
    </c-card-header>
    <c-card-body>
        <div cRow [gutter]="2" class="mb-2">   
            <c-col [md]="3">
              <label cLabel for="Department">Department<span class="text-danger"></span></label>
              <div class="input-wrapper">
                <select (change)="onDepartmentSelect(departmentId)"
                    [(ngModel)]="departmentId" name="departmentId" #Department="ngModel"
                    cFormControl id="Department" aria-label="Default select example" cSelect>
                    <option [ngValue]=0>Select Department</option>
        
                    @for(department of departments; track department.id;let index=$index) {
                    <option [value]="department.id">
                    {{ department.name }}
                    </option>
                    }
                </select>
              </div>
          </c-col>
          
          <c-col [md]="3">
              <label cLabel for="sectionId">Section<span class="text-danger"></span></label>
              <div class="input-wrapper">
                <select [(ngModel)]="sectionId" name="sectionId" #Section="ngModel"
                    cFormControl id="sectionId" aria-label="Default select example" cSelect
                    (change)="onSectionSelect()">
                    <option [ngValue]=0>Select Section</option>
        
                    @for(section of sections; track section.id;let index=$index) {
                    <option [value]="section.id">
                    {{ section.name }}
                    </option>
                    }
                </select>
              </div>
          </c-col>
        </div>

        <c-card class="mt-2" >
            <c-card-header class="text-end">
                Total Employee = {{totalEmployee}}
            </c-card-header>
            <c-card-body class="p-0">
                <!-- <div class="table-responsive">
                    <table mat-table [dataSource]="dataSource" multiTemplateDataRows>
                      <ng-container matColumnDef="slNo">
                        <th mat-header-cell *matHeaderCellDef>SL</th>
                        <td mat-cell *matCellDef="let element; let i = index">{{ i + 1 }}</td>
                      </ng-container>
                      
                      <ng-container matColumnDef="employee">
                        <th mat-header-cell *matHeaderCellDef>Employee</th>
                        <td mat-cell *matCellDef="let element">
                            {{ element.empName }} ({{ element.idCardNo }})
                        </td>
                      </ng-container>
            
                      <ng-container matColumnDef="section">
                        <th mat-header-cell *matHeaderCellDef>Section</th>
                        <td mat-cell *matCellDef="let element">
                          <label *ngIf="element.sectionName">{{ element.sectionName}}</label>
                        </td>
                      </ng-container>
                      
                      <ng-container matColumnDef="designation">
                        <th mat-header-cell *matHeaderCellDef>Designation</th>
                        <td mat-cell *matCellDef="let element">
                          {{ element.designationName }}
                        </td>
                      </ng-container>

                      
                      <ng-container matColumnDef="phone">
                        <th mat-header-cell *matHeaderCellDef>Mobile</th>
                        <td mat-cell *matCellDef="let element">
                          {{ element.mobile }}
                        </td>
                      </ng-container>
                      
                      <ng-container matColumnDef="joinDate">
                        <th mat-header-cell *matHeaderCellDef>Join Date</th>
                        <td mat-cell *matCellDef="let element">
                          {{ element.joinDate }}
                        </td>
                      </ng-container>
                      
                      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                      <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
                    </table>
                </div> -->

                <div class="card">
                    <p-table 
                        [value]="employees"
                        [scrollable]="true" 
                        rowGroupMode="subheader" 
                        groupRowsBy="departmentName">
                            <ng-template pTemplate="header">
                                <tr>
                                    <th>Name</th>
                                    <th>Designation</th>
                                    <th>Section</th>
                                    <th>Mobile</th>
                                    <th>Join Date</th>
                                </tr>
                            </ng-template>
                            <ng-template pTemplate="groupheader" let-customer>
                                <tr pRowGroupHeader>
                                    <td colspan="5">
                                        <span><b>{{customer.departmentName}}<span *ngIf="customer.sectionName">, {{customer.sectionName}}</span></b></span>
                                    </td>
                                </tr>
                            </ng-template>
                            <ng-template pTemplate="body" let-customer let-rowIndex="rowIndex">
                                <tr>
                                    <td>
                                        {{customer.empName}}
                                    </td>
                                    <td>
                                        {{customer.designationName}}
                                    </td>
                                    <td>
                                        {{customer.sectionName}}
                                    </td>
                                    <td>
                                        {{customer.mobile}}
                                    </td>
                                    <td>
                                        {{customer.joinDate}}
                                    </td>
                                </tr>
                            </ng-template>
                    </p-table>
                </div>
            </c-card-body>
            <c-card-footer class="text-medium-emphasis p-0">
                <mat-paginator 
                  [length]="pagination.length"
                  [pageSize]="pagination.pageSize"
                  [pageSizeOptions]="pagination.pageSizeOptions"
                  [showFirstLastButtons]="true"
                  (page)="onPageChange($event)">
                </mat-paginator>    
            </c-card-footer>
        </c-card>
    </c-card-body>
</c-card>
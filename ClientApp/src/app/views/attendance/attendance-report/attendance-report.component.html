<c-card>
    <c-card-header>
        Attendance Report
    </c-card-header>
    <c-card-body>
        <c-card>
            <c-card-body [gutter]="3">
                <form (ngSubmit)="onSubmit()" #filterform="ngForm">
                <c-row>
                    <c-col md="6">
                        <div>
                        <label for="dateRange" cLabel>Date Range</label>
                        </div>
                        <p-calendar 
                        [style]="{height: '2.37rem'}"
                        name="dateRange"
                        [(ngModel)]="rangeDates" 
                        [touchUI]="true"
                        selectionMode="range"
                        showIcon="true"
                        />
                    </c-col>
                </c-row>
                <c-row class="mt-3">
                    <c-col md="2">
                        <label for="office" cLabel>Office</label>
                        <select name="officeId" id="office" cSelect [(ngModel)]="selectedOffice"
                        (change)="onOfficeChange()"
                        >
                            <option [ngValue]="null" selected>Select Office</option>

                            @for (office of OfficeOption; track $index) {
                                <option [ngValue]="office.id" >{{office.name}}</option>
                            }
                        </select>
                    </c-col>
                    <c-col md="2">
                        <label for="department" cLabel>Department</label>
                        <select name="departmentId" id="department" cSelect [(ngModel)]="selectedDepartment"
                        (change)="onDepartmentChange()"
                        >
                            <option [ngValue]="null" cDropdownItem>Select Department</option>
                            @for (department of DepartmentOption; track $index) {
                                <option [ngValue]="department.id">{{department.name}}</option>
                            }
                        </select>
                    </c-col>
                    <c-col md="2">
                        <label for="designation" cLabel>Designation</label>
                        <select name="designationId" id="designation" cSelect [(ngModel)]="selectedDesignation"
                        (change)="onDesignationChange()"
                        >
                            <option [ngValue]="null" cDropdownItem selected>Select Designation</option>
                            @for (designation of DesignationOption; track $index) {
                                <option [ngValue]="designation.id">{{designation.name}}</option>
                            }
                        </select>
                    </c-col>
                    <c-col md="2">
                        <label for="shift" cLabel>Shift</label>
                        <select name="shiftId" id="shift" cSelect [(ngModel)]="selectedShift">
                            <option [ngValue]="null" cDropdownItem selected>Select Shift</option>
                            @for (shift of ShiftOption; track $index) {
                                <option [ngValue]="shift.id">{{shift.name}}</option>
                            }
                        </select>
                    </c-col>
                    <c-col md="2">
                        <label for="emp" cLabel>Employee</label>
                        <select name="empId" id="emp" cSelect>
                            <option [ngValue]="null" cDropdownItem>Select Employee</option>
                            @for (employee of EmployeeOption; track $index) {
                                <option [ngValue]="employee.id">{{employee.name}}</option>
                            }
                        </select>
                    </c-col>
                </c-row>
                <c-row class="mt-3">
                    <c-col md="3">
                        <button type="submit" cButton class="btn btn-success"
                        [disabled]="loading||rangeDates.length==0"
                        >Show Report</button>
                    </c-col>
                </c-row>
                </form>
            </c-card-body>
        </c-card>
        <c-card class="mt-2">
            <c-card-body>
                <p-table styleClass="p-datatable-striped" [columns]="dynamicColumn" [value]="tableData" [tableStyle]="{'min-width': '50rem'}">
                    <ng-template pTemplate="header" let-columns>
                        <tr>
                            @for ( col of staticColumnsBefore; track $index) {
                                <th>{{col.header}}</th>
                            }
                            @for (column of columns; track $index) {
                                <th class="text-nowrap">{{column.header}}</th>
                            }

                        </tr>
                    </ng-template>
                    <ng-template pTemplate="body" let-rowData let-columns="columns">
                        <tr>
                            @for(col of staticColumnsBefore; track $index) {
                                <td>{{rowData[col.field]}}</td>
                            }
                            @for (col of columns; track $index) {
                                <td>
                                    @if (rowData[col.field]==null||rowData[col.field]=="Absent") {
                                        <svg [cIcon]="icons.cibXPack" cTooltip="Hello World"></svg>
                                    } @else {
                                        <svg [cIcon]="icons.cibVerizon" cTooltip="Hello World"></svg><i class="cib-verizon"></i>
                                    }
                                </td>
                            }
                        </tr>
                    </ng-template>
                </p-table>
            </c-card-body>
        </c-card>
    </c-card-body>
</c-card>